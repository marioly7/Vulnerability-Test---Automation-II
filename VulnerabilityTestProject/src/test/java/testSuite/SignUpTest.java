package testSuite;

import org.junit.jupiter.api.*;
import pages.*;
import session.Session;

public class SignUpTest {

    @BeforeEach
    public void openBrowser(){
        Session.getSession().getBrowser().get("https://juice-shop.herokuapp.com/");
    }

    @AfterEach
    public void closeBrowser(){
        Session.getSession().getBrowser().quit();
    }

    @Test
    @Order(1)
    public void verifyLoginSuccessfully() {

        WarningSection warningSection = new WarningSection();
        warningSection.dissmissButton.click();

        AccountNavbarSection accountNavbarSection = new AccountNavbarSection();
        accountNavbarSection.accountButton.click();

        LoginNavbarSection loginNavbarSection = new LoginNavbarSection();
        loginNavbarSection.loginButton.click();

        LoginPage loginPage = new LoginPage();
        loginPage.newCustomerLink.click();

        SignUpPage signUpPage = new SignUpPage();
        signUpPage.emailInput.sendKeys("marioly-test-99@gmail.com");
        signUpPage.passwordInput.sendKeys("12345test");
        signUpPage.repeatPasswordInput.sendKeys("12345test");

        SecurityQuestionsSection securityQuestionsSection = new SecurityQuestionsSection();
        securityQuestionsSection.securityQuestion.click();

        SecurityQuestionsPanelSection securityQuestionsPanelSection = new SecurityQuestionsPanelSection();
        securityQuestionsPanelSection.selectSecurityQuestion("Mother's maiden name?");

        signUpPage.securityAnswer.sendKeys("Molly");
        signUpPage.createAccountButton.click();

        Assertions.assertTrue(loginPage.successMessageIsDisplayed(),"ERROR! No se muestra el mensaje de registro exitoso");

    }
}
